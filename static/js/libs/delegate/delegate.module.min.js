const ledger=new WeakMap;function editLedger(e,t,n,r){var a,o;if(!e&&!ledger.has(t))return!1;const s=null!==(a=ledger.get(t))&&void 0!==a?a:new WeakMap;ledger.set(t,s);const c=null!==(o=s.get(n))&&void 0!==o?o:new Set;s.set(n,c);const l=c.has(r);return e?c.add(r):c.delete(r),l&&e}function safeClosest(e,t){let n=e.target;if(n instanceof Text&&(n=n.parentElement),n instanceof Element&&e.currentTarget instanceof Element){const r=n.closest(t);if(r&&e.currentTarget.contains(r))return r}}function delegate(e,t,n,r={}){const{signal:a,base:o=document}=r;if(null!=a&&a.aborted)return;const{once:s,...c}=r,l=o instanceof Document?o.documentElement:o,d=Boolean("object"==typeof r?r.capture:r),i=r=>{const a=safeClosest(r,e);if(a){const e=Object.assign(r,{delegateTarget:a});n.call(l,e),s&&(l.removeEventListener(t,i,c),editLedger(!1,l,n,g))}},g=JSON.stringify({selector:e,type:t,capture:d});editLedger(!0,l,n,g)||l.addEventListener(t,i,c),null==a||a.addEventListener("abort",(()=>{editLedger(!1,l,n,g)}))}export default delegate;